<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Spelling Bee — Standalone</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    body { background: #faf8ef; }
    @keyframes shake { 10% { transform: translateX(-2px); } 30% { transform: translateX(2px);} 50% { transform: translateX(-2px);} 70% { transform: translateX(2px);} 90% { transform: translateX(-1px);} 100% { transform: translateX(0);} }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">

// React component code
const { useMemo, useState, useEffect } = React;

// Minimal puzzle data
const PUZZLES = [
  { center: "n", letters: ["n","i","g","a","s","e","r"], words: ["siren","resin","singer","reins","raise","grain","sing","singe"] },
  { center: "a", letters: ["a","l","t","r","c","e","p"], words: ["alert","alter","lateral","relate","pearl","parcel","tracer","trace"] },
  { center: "o", letters: ["o","m","d","h","r","a","t"], words: ["motor","tomato","moor","room","rotor","format","aroma","door"] }
];

function isPangram(word, letters) {
  const set = new Set(word.split(""));
  return letters.every(l => set.has(l));
}
function scoreWord(word, letters) {
  if (word.length === 4) return 1;
  let score = word.length;
  if (isPangram(word, letters)) score += 7;
  return score;
}
function computeMaxScore(words, letters) {
  return words.reduce((sum, w) => sum + scoreWord(w, letters), 0);
}
function rankFromScore(score, maxScore) {
  const pct = maxScore ? score / maxScore : 0;
  if (pct >= 1) return { label: "Queen Bee", emoji: "👑" };
  if (pct >= 0.7) return { label: "Genius", emoji: "🧠" };
  if (pct >= 0.5) return { label: "Amazing", emoji: "✨" };
  if (pct >= 0.35) return { label: "Great", emoji: "👍" };
  if (pct >= 0.2) return { label: "Nice", emoji: "🙂" };
  if (pct >= 0.1) return { label: "Good", emoji: "👌" };
  return { label: "Beginner", emoji: "🐝" };
}
function shuffle(arr) {
  const a = arr.slice();
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

function Hive({ letters, center, onKey }) {
  const order = useMemo(() => {
    const others = letters.filter(l => l !== center);
    return [
      { pos: "top", l: others[0] },
      { pos: "tr", l: others[1] },
      { pos: "br", l: others[2] },
      { pos: "bottom", l: others[3] },
      { pos: "bl", l: others[4] },
      { pos: "tl", l: others[5] },
    ];
  }, [letters, center]);
  return (
    <div className="relative w-[280px] h-[260px] mx-auto">
      <Hex label={center} center onClick={() => onKey(center)} style={{ left: 110, top: 95 }} />
      {order.map(o => <Hex key={o.pos} label={o.l} onClick={() => onKey(o.l)} style={posToCoord(o.pos)} />)}
    </div>
  );
}
function posToCoord(pos) {
  const map = {
    top: { left: 110, top: 20 },
    tr: { left: 190, top: 58 },
    br: { left: 190, top: 132 },
    bottom: { left: 110, top: 170 },
    bl: { left: 30, top: 132 },
    tl: { left: 30, top: 58 },
  };
  return map[pos] || { left: 0, top: 0 };
}
function Hex({ label, center = false, onClick, style }) {
  return (
    <button onClick={onClick} style={style}
      className={\`absolute w-20 [aspect-ratio:1.15] grid place-items-center text-2xl font-semibold rounded-[8px] transition shadow-sm \${center ? "bg-yellow-400 text-zinc-900" : "bg-zinc-200 text-zinc-800 hover:bg-zinc-300"}\`}>
      <span className="select-none uppercase tracking-wide">{label}</span>
    </button>
  );
}

function App() {
  const [puzzleIndex, setPuzzleIndex] = useState(() => Math.floor(Math.random() * PUZZLES.length));
  const puzzle = PUZZLES[puzzleIndex];
  const [letters, setLetters] = useState(puzzle.letters);
  const [input, setInput] = useState("");
  const [found, setFound] = useState([]);
  const [message, setMessage] = useState("");
  const [shake, setShake] = useState(false);
  const [showList, setShowList] = useState(false);
  const maxScore = useMemo(() => computeMaxScore(puzzle.words, puzzle.letters), [puzzle]);
  const score = useMemo(() => found.reduce((sum, w) => sum + scoreWord(w, puzzle.letters), 0), [found, puzzle]);
  const rank = rankFromScore(score, maxScore);
  const center = puzzle.center;
  const outer = useMemo(() => letters.filter(l => l !== center), [letters, center]);

  useEffect(() => {
    const handler = e => {
      if (e.key === "Enter") return submit();
      if (e.key === "Backspace") return setInput(v => v.slice(0, -1));
      if (/^[a-zA-Z]$/.test(e.key)) {
        const k = e.key.toLowerCase();
        if (letters.includes(k)) setInput(v => (v + k).slice(0, 24));
      }
    };
    window.addEventListener("keydown", handler);
    return () => window.removeEventListener("keydown", handler);
  });

  const submit = () => {
    const word = input.toLowerCase();
    if (word.length < 4) return bump("Too short");
    if (!word.includes(center)) return bump(`Must include '${center.toUpperCase()}'`);
    if (!word.split("").every(c => letters.includes(c))) return bump("Invalid letters");
    if (!puzzle.words.includes(word)) return bump("Not in word list");
    if (found.includes(word)) return bump("Already found");
    setFound(f => [...f, word].sort());
    setInput("");
    setMessage(isPangram(word, puzzle.letters) ? "Pangram! +7" : "Nice!");
  };
  const bump = msg => {
    setMessage(msg);
    setShake(true);
    setTimeout(() => setShake(false), 300);
  };
  const shuffleOuter = () => setLetters([center, ...shuffle(outer)]);
  const copyFound = async () => {
    const text = `Spelling Bee — ${found.length} words, ${score} pts\n` + found.join(", ");
    try { await navigator.clipboard.writeText(text); setMessage("Copied results"); }
    catch { setMessage("Copy failed"); }
  };

  return (
    <div className="w-full max-w-xl mx-auto p-4">
      <div className="flex items-center justify-between mb-4">
        <h1 className="text-xl font-semibold">Spelling Bee</h1>
        <div className="flex gap-2">
          <button className="px-3 py-1.5 rounded-xl bg-zinc-900 text-white text-sm" onClick={() => setPuzzleIndex((i) => (i + 1) % PUZZLES.length)}>New Puzzle</button>
          <button className="px-3 py-1.5 rounded-xl border" onClick={() => setShowList(s => !s)}>{showList ? "Hide List" : "Reveal List"}</button>
        </div>
      </div>
      <div className="rounded-2xl bg-white p-4 mb-4 border">
        <div className="flex justify-between text-sm mb-2">
          <div>Score: {score} / {maxScore}</div>
          <div>{rank.emoji} {rank.label}</div>
        </div>
        <div className="h-2 bg-zinc-100 rounded-full overflow-hidden">
          <div className="h-full bg-yellow-400" style={{ width: `${(score/(maxScore||1))*100}%` }}></div>
        </div>
        <div className="mt-2 text-xs">Center letter: {center.toUpperCase()} — Letters: {puzzle.letters.join(" ").toUpperCase()}</div>
      </div>
      <div className="grid grid-cols-3 gap-4">
        <div className="col-span-2 bg-white p-4 rounded-2xl border">
          <div className={\`flex items-center gap-2 \${shake ? "animate-[shake_0.3s]" : ""}\`}>
            <div className="flex-1 border px-3 py-2">{input.toUpperCase()}</div>
            <button className="bg-zinc-900 text-white px-3 py-2 rounded" onClick={submit}>Enter</button>
          </div>
          <div className="mt-6"><Hive letters={letters} center={center} onKey={k => setInput(v => (v + k).slice(0, 24))} /></div>
          <div className="mt-4 flex gap-2">
            <button className="border px-3 py-1.5 rounded" onClick={() => setInput("")}>Clear</button>
            <button className="border px-3 py-1.5 rounded" onClick={() => setInput(v => v.slice(0, -1))}>Delete</button>
            <button className="border px-3 py-1.5 rounded" onClick={shuffleOuter}>Shuffle</button>
          </div>
        </div>
        <div className="bg-white p-4 rounded-2xl border">
          <div className="flex justify-between mb-2">
            <div>Found ({found.length})</div>
            <div className="flex gap-1 text-xs">
              <button className="border px-2 rounded" onClick={copyFound}>Copy</button>
              <button className="border px-2 rounded" onClick={() => setShowList(s => !s)}>{showList ? "Hide" : "Reveal"}</button>
            </div>
          </div>
          <div className="text-sm max-h-80 overflow-auto">
            {found.map(w => <div key={w} className="flex justify-between border-b"><span>{w.toUpperCase()}</span><span>{scoreWord(w, puzzle.letters)}</span></div>)}
            {showList && puzzle.words.map(w => <div key={w} className="flex justify-between border-b"><span>{w.toUpperCase()}</span><span>{scoreWord(w, puzzle.letters)}</span></div>)}
          </div>
        </div>
      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App />);

  </script>
</body>
</html>
